function timer(){function e(e){clearTimeout(intervalHandle),$(".gameover").html(e),$(".again").css("display","inline-block"),againClick=!0,scores.push(score),highscore(),saveToLocalStorage()}function o(e,o){return o.indexOf(e)>-1}function a(e){return new Set(e).size!==e.length}if(intervalHandle=setTimeout(timer,timeSpeed),snakeHead+=suund,snake.push(snakeHead),1==leftSide&&"left"==move)return void e("Game over");if(1==rightSide&&"right"==move)return void e("Game over");if(1==upSide&&"up"==move)return void e("Game over");if(1==downSide&&"down"==move)return void e("Game over");leftSide=o(snakeHead,leftSideNr),rightSide=o(snakeHead,rightSideNr),upSide=o(snakeHead,upSideNr),downSide=o(snakeHead,downSideNr);var t=a(snake);if(t===!0)return void e("Game over");if($("table td").eq(snakeHead).addClass("snakeHead"),snakeHead==toit){$("table td").removeClass("toit"),toit=Math.floor(50*Math.random());for(var n=0;n<snake.length;n++){if(50==snake.length)return e("The end"),void console.log("snake.length "+snake.length);snake[n]!=toit?n+1==snake.length&&($("table td").eq(toit).addClass("toit"),grow=!0,$(".score").html("Score: "+(score+=scorebonus)),console.log("Toit "+toit)):(toit=Math.floor(50*Math.random()),n=-1)}console.log(snake)}0==grow&&($("table td").eq(snake[0]).removeClass("snakeHead"),snake.shift(),console.log(snake)),grow=!1,moveLock=move}function saveToLocalStorage(){"undefined"!=typeof Storage?(localStorage.scoreStorage=scores,localStorage.storageCheck="true"):alert("Sorry! No Web Storage support..")}function loadLocalStorage(){if("true"==localStorage.storageCheck){var e=localStorage.scoreStorage;scores=e.split(","),console.log("localscore "+scores)}}function highscore(){scores.sort(function(e,o){return o-e}),scores.length>10&&scores.pop(),$(".score-value").html("");for(var e=0;e<scores.length;e++)$(".score-value").append("<li>"+(e+1)+". "+scores[e]+"</li>")}var toit=Math.floor(50*Math.random());console.log("Toit "+toit);var snakeHead=22,snake=[snakeHead-1,snakeHead],grow=!1,suund=1,leftSideNr=[0,10,20,30,40],rightSideNr=[9,19,29,39,49],upSideNr=[0,1,2,3,4,5,6,7,8,9],downSideNr=[40,41,42,43,44,45,46,47,48,49],score=0,scores=[],scorebonus=15,move="right",moveLock=move;$("table td").eq(toit).addClass("toit"),$("table td").eq(snake[0]).addClass("snakeHead"),$("table td").eq(snakeHead).addClass("snakeHead");var timeSpeed=250,leftSide,rightSide,upSide,downSide;$(document).keydown(function(e){var o=parseInt(e.which,10);37==o?"right"!=moveLock&&(move="left",suund=-1):38==o?"down"!=moveLock&&(move="up",suund=-10):39==o?"left"!=moveLock&&(move="right",suund=1):40==o&&"up"!=moveLock&&(move="down",suund=10)}),$(".speed").on("click",function(){$(".btn").removeClass("orange"),$(this).find(".btn").addClass("orange")}),$(".slow").on("click",function(){timeSpeed=500,scorebonus=10}),$(".normal").on("click",function(){timeSpeed=250,scorebonus=15}),$(".fast").on("click",function(){timeSpeed=125,scorebonus=20}),$(".ultra").on("click",function(){timeSpeed=62.5,scorebonus=25});var startClick=!0;$(".start").on("click",function(){startClick===!0&&(timer(),$(this).hide(),startClick=!1)});var againClick=!0;$(".again").on("click",function(){againClick===!0&&($(this).hide(),againClick=!1,toit=Math.floor(50*Math.random()),snakeHead=22,snake=[snakeHead-1,snakeHead],grow=!1,score=0,suund=1,move="right",moveLock=move,leftSide=null,rightSide=null,upSide=null,downSide=null,$(".score").html("Score: 0"),$(".gameover").html(""),$("table td").removeClass("toit snakeHead"),$("table td").eq(toit).addClass("toit"),$("table td").eq(snake[0]).addClass("snakeHead"),$("table td").eq(snakeHead).addClass("snakeHead"),timer())}),loadLocalStorage(),highscore();